# -- stackhawk configuration for Vida+ --
app:
  # -- An applicationId obtained from the StackHawk platform. --
  applicationId: 3f0b1391-b4e4-41b3-aad4-31a2afd2bbcf # (required)
  # -- The environment for the applicationId defined in the StackHawk platform. --
  env: Development # (required)
  # -- The url of your application to scan --
  #host: https://csi.dev.cloudsol.lk # (required)
  host: https://vida.cloudsolutions.com.sa
  excludePaths:
    - /auth/resources/.*
  includePaths:
    - /csi-api/.*

# -- Customized Configuration for GraphQL/SOAP/OpenAPI, add here --
  openApiConf:
  #  path: /csi-api/csi-pms-rms-masterdata/amd-masterdata/v2/api-docs # OR...
    filePath: rms-masterdata.json
  autoPolicy: true
  autoInputVectors: true
  # Configuration Docs: https://docs.stackhawk.com/hawkscan/configuration/

# -- If Authenticated Scanning is needed, add here --
  # Authenticated Scanning Docs: https://docs.stackhawk.com/hawkscan/authenticated-scanning.html
  # Authenticated Scanning Repo: https://github.com/kaakaww/scan-configuration/tree/main/Authentication

# -- Help Section --
  # Docs: https://docs.stackhawk.com/
  # Contact Support: support@stackhawk.com
  authentication:
    loggedInIndicator: HTTP\/\d+\.\d+\s+(2[0-9][0-9]|3[0-9][0-9])
    loggedOutIndicator: HTTP\/\d+\.\d+\s+(4[0-9][0-9])
    # authn
    script:
      name: auth-user.js
      parameters:
        issuer: https://vida.cloudsolutions.com.sa/auth/realms/vidaqa/protocol/openid-connect/token
        grant_type: password
      credentials:
        client_id: app
        #client_secret: c8e6efae-c222-4cad-8ca5-bdf0dfd312a2
        username: "3033"
        password: "123"
    # authz
    tokenExtraction:
      type: TOKEN_PATH
      value: access_token
    tokenAuthorization:
      type: HEADER
      value: Authorization
      tokenType: bearer
    testPath:
      path: /csi-api/csi-pms-rms-masterdata/amd-masterdata/swagger-ui.html
      success: '.*200.*'
hawkAddOn:
  scripts:
    - name: auth-user.js
      type: authentication
      path: scripts
      language: JAVASCRIPT